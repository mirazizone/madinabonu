# Диагностика и решение проблем с загрузкой фото

## Проблема: Фото не выбирается или выбирается но сразу сбрасывается

### Возможные причины и решения:

### 1. **Проверьте права доступа к папке storage**

Запустите скрипт для установки правильных прав:
```bash
php fix-permissions.php
```

### 2. **Проверьте PHP конфигурацию**

Откройте `php.ini` и убедитесь, что:
```
upload_max_filesize = 2M    (или больше)
post_max_size = 2M          (или больше)
max_execution_time = 30     (или больше)
```

### 3. **Проверьте папку storage/app/public**

Убедитесь что она существует и имеет права на запись:
```powershell
# Windows PowerShell
Get-Item "storage\app\public" | Select-Object -Property Name, Mode

# Должно быть:
# Mode: d----- (директория)
```

### 4. **Очистите браузер кэш**

- F12 > Application > Clear storage
- Или используйте InPrivate/Incognito режим

### 5. **Проверьте ошибки на сервере**

Откройте диагностическую страницу:
```
http://localhost/diagnostics.php
```

Там будут подробные сведения о конфигурации.

### 6. **Проверьте логи Laravel**

```bash
# Посмотрите последние ошибки
storage/logs/laravel.log
```

## Обновления формы загрузки:

### ✅ Что было добавлено:

1. **Preview фото** - видите выбранное фото перед загрузкой
2. **Клиентская валидация** - проверка размера и типа файла перед отправкой
3. **Обработка ошибок** - правильные сообщения об ошибках
4. **Лучший UX** - понятные инструкции и текст
5. **Диагностика** - автоматическая проверка конфигурации

## Как загрузить фото правильно:

1. **Создайте или отредактируйте учителя**
   - Admin Panel → O'qituvchilar → Yangi o'qituvchi yoki tahrirlash

2. **Выберите фото**
   - Нажмите на "Rasm" поле
   - Выберите файл (JPG, PNG или GIF)
   - Вы сразу увидите preview

3. **Проверьте ограничения:**
   - Максимум 2MB
   - Форматы: JPG, PNG, GIF
   - Рекомендуемый размер: 300x300px или больше

4. **Сохраните**
   - Нажмите "Saqlash" или "Yangilash"

5. **Проверьте результат**
   - Перейдите на главную страницу
   - Раздел "Bizning Jamoa" должен показать загруженное фото

## Если всё ещё не работает:

1. Запустите `php artisan storage:link` (требует прав администратора)
2. Перезагрузите веб-сервер
3. Очистите браузер кэш (Ctrl+Shift+Del)
4. Попробуйте другой браузер
5. Проверьте логи ошибок в `storage/logs/laravel.log`

## Технические детали:

### Папки и права:
- `storage/app/public/teachers/` - где хранятся фото
- Требуется право на запись (writable)

### URL для доступа к фото:
- Формат: `/storage/teachers/{filename}`
- Пример: `/storage/teachers/5R1REnVfRUrlwI95HL5Zo02JAhKatTwUXc73KCqJ.png`

### Поддерживаемые форматы:
- JPEG (jpg, jpeg)
- PNG (png)
- GIF (gif)

### Максимальный размер: 2MB

## Команды для диагностики:

```bash
# Создать папку для фото если её нет
mkdir -p storage\app\public\teachers

# Установить права доступа
php fix-permissions.php

# Создать символическую ссылку (требует админ права)
php artisan storage:link

# Проверить конфигурацию Laravel
php artisan config:show filesystems
```
